<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="crm-timezone" content="{{ CRM_TIMEZONE }}">
  <title>{% block title %}CRM Extender{% endblock %}</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
  <link rel="stylesheet" href="/static/style.css">
  <link rel="stylesheet" href="/static/notes.css">
  <script src="https://unpkg.com/htmx.org@2.0.4"></script>
  <script type="importmap">
  {
    "imports": {
      "@tiptap/core": "https://esm.sh/@tiptap/core@2.11.5",
      "@tiptap/starter-kit": "https://esm.sh/@tiptap/starter-kit@2.11.5",
      "@tiptap/extension-image": "https://esm.sh/@tiptap/extension-image@2.11.5",
      "@tiptap/extension-link": "https://esm.sh/@tiptap/extension-link@2.11.5",
      "@tiptap/extension-placeholder": "https://esm.sh/@tiptap/extension-placeholder@2.11.5",
      "@tiptap/extension-mention": "https://esm.sh/@tiptap/extension-mention@2.11.5",
      "@tiptap/suggestion": "https://esm.sh/@tiptap/suggestion@2.11.5"
    }
  }
  </script>
</head>
<body>
  <nav class="container-fluid">
    <ul>
      <li><a href="/"><strong>CRM Extender</strong></a></li>
    </ul>
    <ul>
      <li><a href="/" {% if active_nav == 'dashboard' %}class="active"{% endif %}>Dashboard</a></li>
      <li><a href="/conversations" {% if active_nav == 'conversations' %}class="active"{% endif %}>Conversations</a></li>
      <li><a href="/communications" {% if active_nav == 'communications' %}class="active"{% endif %}>Communications</a></li>
      <li><a href="/contacts" {% if active_nav == 'contacts' %}class="active"{% endif %}>Contacts</a></li>
      <li><a href="/companies" {% if active_nav == 'companies' %}class="active"{% endif %}>Companies</a></li>
      <li><a href="/projects" {% if active_nav == 'projects' %}class="active"{% endif %}>Projects</a></li>
      <li><a href="/relationships" {% if active_nav == 'relationships' %}class="active"{% endif %}>Relationships</a></li>
      <li><a href="/events" {% if active_nav == 'events' %}class="active"{% endif %}>Events</a></li>
      <li><a href="/notes/search" {% if active_nav == 'notes' %}class="active"{% endif %}>Notes</a></li>
      <li><a href="/views" {% if active_nav == 'views' %}class="active"{% endif %}>Views</a></li>
    </ul>
    {% if user %}
    <ul>
      <li><small>{{ user.name or user.email }}</small></li>
      <li><a href="/settings/profile" {% if active_nav == 'settings' %}class="active"{% endif %}
          style="font-size:0.8rem;">Settings</a></li>
      <li>
        <form method="post" action="/logout" style="margin:0;">
          <button type="submit" class="outline secondary" style="padding:0.25rem 0.5rem; margin:0; font-size:0.8rem;">Logout</button>
        </form>
      </li>
    </ul>
    {% endif %}
  </nav>

  <main class="container-fluid">
    <div id="flash-messages">
      {% if flash %}
      <article class="flash-{{ flash.level }}">
        <p>{{ flash.message }}</p>
      </article>
      {% endif %}
    </div>

    {% block content %}{% endblock %}
  </main>

  <footer class="container-fluid">
    <small>CRM Extender</small>
  </footer>
  <script src="/static/dates.js"></script>
  <script src="/static/inline_edit.js"></script>
  <script type="module" src="/static/notes.js"></script>
</body>
</html>
