<div id="phones-section">
  <h2>Phone Numbers ({{ phones|length }})</h2>
  {% if phone_error %}
  <article style="padding:0.5rem 1rem; background:var(--pico-del-color);">
    <p>{{ phone_error }}</p>
  </article>
  {% endif %}
  {% if phones %}
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Number</th>
        <th>Period</th>
        <th>Status</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for phone in phones %}
      <tr{% if not phone.is_current %} style="opacity:0.6;"{% endif %}>
        <td>{{ phone.phone_type }}{% if not phone.is_current %} <small>(former)</small>{% endif %}</td>
        <td>{{ phone.number | format_phone(display_country|default('US')) }}</td>
        <td>
          {% if phone.started_at %}{{ phone.started_at[:10] }}{% endif %}
          {% if phone.started_at or phone.ended_at %}&ndash;{% endif %}
          {% if phone.ended_at %}{{ phone.ended_at[:10] }}{% elif phone.started_at %}present{% endif %}
        </td>
        <td>
          {% if phone.is_current %}
          <button hx-post="/companies/{{ company.id }}/phones/{{ phone.id }}/edit"
                  hx-vals='{"is_current":"0"}' hx-target="#phones-section" hx-swap="outerHTML"
                  class="outline" style="padding:2px 8px;font-size:.8em;"
                  title="Mark as former">&#128340;</button>
          {% else %}
          <button hx-post="/companies/{{ company.id }}/phones/{{ phone.id }}/edit"
                  hx-vals='{"is_current":"1"}' hx-target="#phones-section" hx-swap="outerHTML"
                  class="outline" style="padding:2px 8px;font-size:.8em;"
                  title="Reactivate">&#8635;</button>
          {% endif %}
        </td>
        <td>
          <button hx-delete="/companies/{{ company.id }}/phones/{{ phone.id }}"
                  hx-target="#phones-section" hx-swap="outerHTML"
                  hx-confirm="Remove this phone number?" class="outline"
                  style="padding:4px 10px;font-size:.85em;">Remove</button>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <p class="empty-state">No phone numbers.</p>
  {% endif %}

  <form hx-post="/companies/{{ company.id }}/phones"
        hx-target="#phones-section" hx-swap="outerHTML">
    <fieldset role="group">
      <select name="phone_type">
        <option value="main">Main</option>
        <option value="work">Work</option>
        <option value="mobile">Mobile</option>
        <option value="fax">Fax</option>
      </select>
      <input type="text" name="number" placeholder="+1 555-0100" required>
      <button type="submit">Add</button>
    </fieldset>
  </form>
</div>
