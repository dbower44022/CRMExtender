{% from "_grid_macros.html" import grid_headers, grid_cells %}
{% set s = sort|default('name', true) %}
{% set sc = scope|default('all', true) %}
{% if rows %}
<table>
  <thead>
    <tr>
      {{ grid_headers(view, entity_def, s, "/companies/search", {"q": q|default('', true), "scope": sc}) }}
      <th></th>
    </tr>
  </thead>
  <tbody>
    {% for row in rows %}
    <tr id="company-{{ row.id }}">
      {{ grid_cells(row, view, entity_def) }}
      <td>
        <button class="outline secondary"
                style="padding:0.2rem 0.5rem;font-size:0.75rem"
                hx-delete="/companies/{{ row.id }}"
                hx-target="#company-{{ row.id }}"
                hx-swap="outerHTML"
                hx-confirm="Delete company '{{ row.name }}'?">Delete</button>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<p class="empty-state">No companies found.</p>
{% endif %}
