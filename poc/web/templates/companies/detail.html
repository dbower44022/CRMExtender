{% extends "base.html" %}
{% block title %}{{ company.name }} â€” CRM Extender{% endblock %}

{% block content %}
<h1>{{ company.name }}</h1>

<div class="grid">
  <div>
    <h2>Contacts ({{ contacts|length }})</h2>
    {% if contacts %}
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Email</th>
        </tr>
      </thead>
      <tbody>
        {% for c in contacts %}
        <tr>
          <td><a href="/contacts/{{ c.id }}">{{ c.name or '(unnamed)' }}</a></td>
          <td>{{ c.email or '' }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <p class="empty-state">No contacts linked to this company.</p>
    {% endif %}

    {% if relationships %}
    <h2>Relationships ({{ relationships|length }})</h2>
    <table>
      <thead>
        <tr>
          <th>Label</th>
          <th>Entity</th>
          <th>Type</th>
          <th>Source</th>
        </tr>
      </thead>
      <tbody>
        {% for rel in relationships %}
        <tr>
          <td><em>{{ rel.label }}</em></td>
          <td>
            {% if rel.other_entity_type == 'contact' %}
            <a href="/contacts/{{ rel.other_id }}">{{ rel.other_name }}</a>
            {% else %}
            <a href="/companies/{{ rel.other_id }}">{{ rel.other_name }}</a>
            {% endif %}
          </td>
          <td>{{ rel.type_name }}</td>
          <td>{{ rel.source }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% endif %}
  </div>

  <div>
    <article>
      <header>Company Info</header>
      <dl class="detail-sidebar">
        {% if company.domain %}
        <dt>Domain</dt>
        <dd>{{ company.domain }}</dd>
        {% endif %}
        {% if company.industry %}
        <dt>Industry</dt>
        <dd>{{ company.industry }}</dd>
        {% endif %}
        {% if company.description %}
        <dt>Description</dt>
        <dd>{{ company.description }}</dd>
        {% endif %}
        <dt>Status</dt>
        <dd>{{ company.status or 'active' }}</dd>
      </dl>
    </article>
  </div>
</div>
{% endblock %}
