{% extends "base.html" %}
{% block title %}Companies â€” CRM Extender{% endblock %}

{% block content %}
<h1>Companies <small>({{ companies|length }})</small></h1>

<div class="grid">
  <div>
    <div class="search-bar">
      <input type="search" name="q" value="{{ q }}"
             placeholder="Search name or domain..."
             hx-get="/companies/search"
             hx-trigger="input changed delay:300ms, search"
             hx-target="#results"
             hx-vals='{"sort": "{{ sort|default('name', true) }}"}'
             hx-push-url="/companies">
      <span class="htmx-indicator" aria-busy="true"></span>
    </div>

    <div style="margin-bottom: 1rem;">
      <button hx-post="/companies/resolve-domains"
              hx-target="#resolve-result"
              hx-swap="innerHTML"
              class="outline">Resolve Domains</button>
      <span id="resolve-result" style="margin-left: 0.5rem;"></span>
    </div>

    <div id="results">
      {% include "companies/_rows.html" %}
    </div>
  </div>

  <div id="company-form-area">
    <article>
      <header>New Company</header>
      {% include "companies/_form.html" %}
    </article>
  </div>
</div>
{% endblock %}
